import{f as P,u as g,R as e,r as u,b as h,c as b,o as y,F as D,l as M,n as w,q as R,t as _,v as $,w as T,x as j,y as z,z as S,A as G,B as q,C as O,D as V,E as B,k as H}from"./index-BS11OSAT.js";const J=()=>{const{stats:a,moduleProgress:o}=P(),{userProfile:v}=g(),m=r=>Math.floor(r/1e3)+1,n=r=>{const l=m(r);return(r-(l-1)*1e3)/1e3*100},N=m((a==null?void 0:a.totalPoints)||0),E=n((a==null?void 0:a.totalPoints)||0);return e.createElement("div",{className:"user-progress-container"},e.createElement("div",{className:"user-stats"},e.createElement("div",{className:"stat-card"},e.createElement("h3",null,"Nivel"),e.createElement("div",{className:"stat-value"},N),e.createElement("div",{className:"progress-bar"},e.createElement("div",{className:"progress-fill",style:{width:`${E}%`}})),e.createElement("div",{className:"progress-text"},Math.round(E),"% al siguiente nivel")),e.createElement("div",{className:"stat-card"},e.createElement("h3",null,"Puntos Totales"),e.createElement("div",{className:"stat-value"},(a==null?void 0:a.totalPoints)||0)),e.createElement("div",{className:"stat-card"},e.createElement("h3",null,"MÃ³dulos Completados"),e.createElement("div",{className:"stat-value"},(a==null?void 0:a.modulesCompleted)||0,"/6")),e.createElement("div",{className:"stat-card"},e.createElement("h3",null,"Logros Desbloqueados"),e.createElement("div",{className:"stat-value"},(a==null?void 0:a.achievementsUnlocked)||0))),e.createElement("div",{className:"module-progress"},e.createElement("h3",null,"Progreso por MÃ³dulo"),e.createElement("div",{className:"modules-grid"},Object.entries(o).map(([r,l])=>e.createElement("div",{key:r,className:"module-card"},e.createElement("h4",null,"MÃ³dulo ",parseInt(r)+1),e.createElement("div",{className:"module-status"},l!=null&&l.completed?e.createElement("span",{className:"status completed"},"Completado"):l!=null&&l.started?e.createElement("span",{className:"status in-progress"},"En Progreso"):e.createElement("span",{className:"status not-started"},"No Iniciado")),(l==null?void 0:l.score)&&e.createElement("div",{className:"module-score"},"PuntuaciÃ³n: ",l.score,"%"))))))},K=()=>{const{stats:a}=P(),{userProfile:o}=g(),v=[{id:"first_module",title:"Primer MÃ³dulo",description:"Completaste tu primer mÃ³dulo",icon:"ðŸŽ¯",points:100},{id:"perfect_score",title:"PuntuaciÃ³n Perfecta",description:"Obtuviste 100% en una evaluaciÃ³n",icon:"â­",points:200},{id:"fast_learner",title:"Aprendiz RÃ¡pido",description:"Completaste un mÃ³dulo en menos de 30 minutos",icon:"âš¡",points:150},{id:"module_master",title:"Maestro de MÃ³dulos",description:"Completaste todos los mÃ³dulos",icon:"ðŸ‘‘",points:500},{id:"evaluation_expert",title:"Experto en Evaluaciones",description:"Completaste todas las evaluaciones",icon:"ðŸŽ“",points:300},{id:"consistent_learner",title:"Aprendiz Consistente",description:"Accediste a la plataforma durante 7 dÃ­as seguidos",icon:"ðŸ“…",points:250}],m=(o==null?void 0:o.achievements)||[];return e.createElement("div",{className:"achievements-container"},e.createElement("h2",null,"Logros"),e.createElement("div",{className:"achievements-grid"},v.map(n=>e.createElement("div",{key:n.id,className:`achievement-card ${m.includes(n.id)?"unlocked":"locked"}`},e.createElement("div",{className:"achievement-icon"},n.icon),e.createElement("h3",null,n.title),e.createElement("p",null,n.description),e.createElement("div",{className:"achievement-points"},"+",n.points," puntos"),m.includes(n.id)&&e.createElement("div",{className:"achievement-badge"},"Desbloqueado")))))},A=[{id:"astronaut",icon:M,name:"Astronauta"},{id:"ninja",icon:w,name:"Ninja"},{id:"secret",icon:R,name:"Agente Secreto"},{id:"tie",icon:_,name:"Ejecutivo"},{id:"graduate",icon:$,name:"Graduado"},{id:"shield",icon:T,name:"GuardiÃ¡n"},{id:"cog",icon:j,name:"Ingeniero"},{id:"alt",icon:z,name:"Alternativo"},{id:"circle",icon:S,name:"CÃ­rculo"},{id:"check",icon:G,name:"Verificado"}],W=()=>{const{currentUser:a}=g(),[o,v]=u.useState(!1),[m,n]=u.useState(""),[N,E]=u.useState(""),[r,l]=u.useState(!1),[c,f]=u.useState({displayName:"",email:"",avatarId:"circle",bio:""}),[p,F]=u.useState({posts:0,comments:0,likes:0,badges:[]});u.useEffect(()=>{if(a){const t=h(b,`users/${a.uid}`);y(t,i=>{const d=i.val();d&&f(L=>({...L,...d}))});const s=h(b,`users/${a.uid}/stats`);y(s,i=>{const d=i.val();d&&F(d)})}},[a]);const C=t=>{const{name:s,value:i}=t.target;f(d=>({...d,[s]:i}))},U=t=>{f(s=>({...s,avatarId:t})),l(!1)},k=async t=>{t.preventDefault(),v(!0),n(""),E("");try{await B(a,{displayName:c.displayName});const s=h(b,`users/${a.uid}`);await H(s,{displayName:c.displayName,bio:c.bio,avatarId:c.avatarId}),E("Perfil actualizado exitosamente")}catch(s){console.error("Error updating profile:",s),n("Error al actualizar el perfil")}v(!1)},I=t=>{const s=A.find(i=>i.id===t);return s?s.icon:S};if(!a)return e.createElement("div",{className:"profile-container"},e.createElement("div",{className:"error-message"},"Debes iniciar sesiÃ³n para ver tu perfil"));const x=I(c.avatarId);return e.createElement("div",{className:"profile-container"},e.createElement("div",{className:"profile-header"},e.createElement("div",{className:"profile-avatar-container"},e.createElement("div",{className:"profile-avatar",onClick:()=>l(!0)},e.createElement(x,{className:"avatar-icon"}),e.createElement("div",{className:"avatar-overlay"},e.createElement(D,null),e.createElement("span",null,"Cambiar avatar")))),e.createElement("div",{className:"profile-info"},e.createElement("h1",null,c.displayName||"Usuario"),e.createElement("p",{className:"profile-email"},c.email))),r&&e.createElement("div",{className:"avatar-selector"},e.createElement("h3",null,"Selecciona tu avatar"),e.createElement("div",{className:"avatar-grid"},A.map(({id:t,icon:s,name:i})=>e.createElement("div",{key:t,className:`avatar-option ${c.avatarId===t?"selected":""}`,onClick:()=>U(t)},e.createElement(s,{className:"avatar-icon"}),e.createElement("span",null,i))))),e.createElement("div",{className:"profile-stats"},e.createElement("div",{className:"stat-card"},e.createElement(q,{className:"stat-icon"}),e.createElement("span",{className:"stat-value"},p.posts),e.createElement("span",{className:"stat-label"},"Posts")),e.createElement("div",{className:"stat-card"},e.createElement(O,{className:"stat-icon"}),e.createElement("span",{className:"stat-value"},p.comments),e.createElement("span",{className:"stat-label"},"Comentarios")),e.createElement("div",{className:"stat-card"},e.createElement(V,{className:"stat-icon"}),e.createElement("span",{className:"stat-value"},p.likes),e.createElement("span",{className:"stat-label"},"Likes"))),e.createElement("form",{onSubmit:k,className:"profile-form"},m&&e.createElement("div",{className:"error-message"},m),N&&e.createElement("div",{className:"success-message"},N),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"displayName"},"Nombre"),e.createElement("input",{type:"text",id:"displayName",name:"displayName",value:c.displayName,onChange:C,required:!0})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"bio"},"BiografÃ­a"),e.createElement("textarea",{id:"bio",name:"bio",value:c.bio,onChange:C,rows:"4",placeholder:"CuÃ©ntanos un poco sobre ti..."})),e.createElement("button",{type:"submit",className:"save-button",disabled:o},o?"Guardando...":"Guardar cambios")),p.badges.length>0&&e.createElement("div",{className:"badges-section"},e.createElement("h2",null,"Insignias"),e.createElement("div",{className:"badges-grid"},p.badges.map((t,s)=>e.createElement("div",{key:s,className:"badge-card"},e.createElement("i",{className:`fas ${t.icon}`}),e.createElement("span",null,t.name))))),e.createElement("div",{className:"profile-content"},e.createElement(J,null),e.createElement(K,null)))};export{W as default};
