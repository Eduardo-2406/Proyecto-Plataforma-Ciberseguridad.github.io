import{r as c,u as N,b as y,c as w,o as x,R as e,m as l}from"./index-BS11OSAT.js";const C=()=>{const[s,m]=c.useState([]),[f,o]=c.useState(!0),[d,u]=c.useState(""),{currentUser:n}=N();c.useEffect(()=>{if(!n)return;const t=y(w,`users/${n.uid}/certificates`),a=x(t,i=>{try{const r=i.val();if(r){const h=Object.entries(r).map(([g,v])=>({id:g,...v}));m(h)}o(!1)}catch{u("Error al cargar los certificados"),o(!1)}});return()=>a()},[n]);const E=async t=>{try{const a=document.createElement("canvas"),i=a.getContext("2d");a.width=1200,a.height=800,i.fillStyle="#ffffff",i.fillRect(0,0,a.width,a.height),i.strokeStyle="#2563eb",i.lineWidth=20,i.strokeRect(40,40,a.width-80,a.height-80),i.fillStyle="#1a202c",i.font="bold 48px Arial",i.textAlign="center",i.fillText("Certificado de Ciberseguridad",a.width/2,120),i.font="32px Arial",i.fillText(t.title,a.width/2,180),i.font="24px Arial",i.fillText(`Otorgado a: ${t.recipientName}`,a.width/2,300),i.fillText(`Por completar exitosamente: ${t.evaluationTitle}`,a.width/2,350),i.fillText(`Con una puntuación de: ${t.score}%`,a.width/2,400),i.fillText(`Fecha de emisión: ${new Date(t.issueDate).toLocaleDateString()}`,a.width/2,450),i.font="20px Arial",i.fillText(`Código de verificación: ${t.verificationCode}`,a.width/2,550);const r=document.createElement("a");r.download=`certificado-${t.id}.png`,r.href=a.toDataURL("image/png"),r.click()}catch(a){console.error("Error al generar el certificado:",a),alert("Error al generar el certificado")}},p=async t=>{try{const a={title:t.title,text:`¡He obtenido el certificado de ${t.evaluationTitle} en la Plataforma de Ciberseguridad!`,url:window.location.origin};if(navigator.share)await navigator.share(a);else{const i=`${a.title}
${a.text}
${a.url}`;await navigator.clipboard.writeText(i),alert("Enlace copiado al portapapeles")}}catch(a){console.error("Error al compartir:",a)}};return f?e.createElement("div",{className:"certificates-container"},e.createElement("div",{className:"loading"},"Cargando certificados...")):d?e.createElement("div",{className:"certificates-container"},e.createElement("div",{className:"error-message"},d)):e.createElement("div",{className:"certificates-container"},e.createElement(l.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5}},"Mis Certificados"),s.length===0?e.createElement(l.div,{className:"no-certificates",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5}},e.createElement("div",{className:"no-certificates-icon"},e.createElement("i",{className:"fas fa-certificate"})),e.createElement("h3",null,"Aún no tienes certificados"),e.createElement("p",null,"Completa los módulos de aprendizaje y sus evaluaciones para obtener certificados que validen tus conocimientos en ciberseguridad.")):e.createElement(l.div,{className:"certificates-grid",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2}},s.map((t,a)=>e.createElement(l.div,{key:t.id,className:"certificate-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:a*.1}},e.createElement("div",{className:"certificate-header"},e.createElement("div",{className:"certificate-icon"},e.createElement("i",{className:"fas fa-certificate"})),e.createElement("div",{className:"certificate-info"},e.createElement("h3",null,t.title),e.createElement("p",{className:"issue-date"},"Emitido el ",new Date(t.issueDate).toLocaleDateString()))),e.createElement("div",{className:"certificate-details"},e.createElement("div",{className:"detail-item"},e.createElement("i",{className:"fas fa-user"}),e.createElement("span",null,t.recipientName)),e.createElement("div",{className:"detail-item"},e.createElement("i",{className:"fas fa-graduation-cap"}),e.createElement("span",null,t.issuer)),e.createElement("div",{className:"detail-item"},e.createElement("i",{className:"fas fa-check-circle"}),e.createElement("span",null,"Puntuación: ",t.score,"%")),e.createElement("div",{className:"detail-item"},e.createElement("i",{className:"fas fa-shield-alt"}),e.createElement("span",null,"Código: ",t.verificationCode))),e.createElement("div",{className:"certificate-actions"},e.createElement("button",{className:"download-button",onClick:()=>E(t)},e.createElement("i",{className:"fas fa-download"}),"Descargar"),e.createElement("button",{className:"share-button",onClick:()=>p(t)},e.createElement("i",{className:"fas fa-share-alt"}),"Compartir"))))))};export{C as default};
